<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" value="notranslate">
    <title>Vokabelwortfindungsherausforderung</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.9);
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .mode-button {
            padding: 8px 16px;
            margin: 0 10px;
            border: none;
            border-radius: 5px;
            background: #d3d6da;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mode-button.active {
            background: #6aaa64;
            color: white;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.2em;
            margin: 10px 0;
            opacity: 0.9;
        }

        .word-hint {
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .game-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            max-width: 100%;
            width: 90vw;
            max-width: 1200px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(var(--wordlen, 43), 1fr);
            gap: 2px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .cell {
            width: 25px;
            height: 25px;
            border: 2px solid #d3d6da;
            border-radius: 3px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 12px;
            background: white;
            transition: all 0.3s ease;
        }

        .cell.filled {
            border-color: #878a8c;
            background: #f8f9fa;
        }

        .cell.correct {
            background: #6aaa64;
            color: white;
            border-color: #6aaa64;
            animation: flip 0.6s ease-in-out;
        }

        .cell.present {
            background: #c9b458;
            color: white;
            border-color: #c9b458;
            animation: flip 0.6s ease-in-out;
        }

        .cell.absent {
            background: #787c7e;
            color: white;
            border-color: #787c7e;
            animation: flip 0.6s ease-in-out;
        }

        @keyframes flip {
            0% { transform: rotateX(0); }
            50% { transform: rotateX(90deg); }
            100% { transform: rotateX(0); }
        }

        .keyboard {
            display: grid;
            grid-template-columns: repeat(13, 1fr);
            gap: 3px;
            max-width: 800px;
            margin: 0 auto;
        }

        .key {
            padding: 10px 8px;
            border: none;
            border-radius: 4px;
            background: #d3d6da;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            min-height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .key:hover {
            background: #bbb;
        }

        .key.correct {
            background: #6aaa64;
            color: white;
        }

        .key.present {
            background: #c9b458;
            color: white;
        }

        .key.absent {
            background: #787c7e;
            color: white;
        }

        .key.wide {
            grid-column: span 2;
        }

        .message {
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            min-height: 20px;
        }

        .win {
            color: #6aaa64;
            font-size: 1.2em;
        }

        .lose {
            color: #e74c3c;
            font-size: 1.2em;
        }

        .hangman-container {
            display: none;
            margin: 20px auto;
            text-align: center;
        }

        .hangman-drawing {
            width: 200px;
            height: 250px;
            margin: 0 auto;
            position: relative;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
        }

        .hangman-word {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .hangman-letter {
            width: 30px;
            height: 40px;
            border-bottom: 2px solid #333;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .cell {
                width: 20px;
                height: 20px;
                font-size: 10px;
            }
            .key {
                padding: 8px 4px;
                font-size: 10px;
                min-height: 35px;
            }
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
<div class="header">
    <h1>üá©üá™ Vokabelwortfindungsherausforderung üá©üá™</h1>
    <div class="subtitle">Der Ultimate Deutsche Wortspiel!</div>
</div>

<div class="mode-selector">
    <button id="wordle-mode" class="mode-button active">WordyGuess(tm) Mode</button>
    <button id="hangman-mode" class="mode-button">Hangman Mode</button>
</div>

<div class="word-hint">
    <strong>Hinweis:</strong> Es ist lang
</div>

<div class="game-container">
    <div id="wordle-container">
        <div class="grid" id="grid"></div>
    </div>
    <div id="hangman-container" class="hangman-container">
        <div class="hangman-drawing" id="hangman-drawing">
            <!-- Hangman drawing will be added here by JavaScript -->
        </div>
        <div class="hangman-word" id="hangman-word">
            <!-- Hangman word display will be added here by JavaScript -->
        </div>
    </div>
    <div class="message" id="message"></div>
    <div class="keyboard" id="keyboard"></div>
</div>

<script>
    const localisations = {
        de: {
            options: {
                'Vokabelwortfindungsherausforderung':'Es ist lang',
                'Donaudampfschifffahrtsgesellschaftskapit√§n':'Es ist lang',
                'Rechtsschutzversicherungsgesellschaften':'Es ist lang',
                'Rindfleischetikettierungs√ºberwachungsaufgaben√ºbertragungsgesetz':'Es ist lang',
                'Bet√§ubungsmittelverschreibungsverordnung':'Es ist lang',
                'Grundst√ºcksverkehrsgenehmigungszust√§ndigkeits√ºbertragunsverordnung':'Es ist lang',
                'Sozialversicherungsfachangestelltenauszubildender':'Es ist lang',
                'Stra√üenverkehrszulassungsordnung':'Es ist lang',
                'Vierhundertvierundvierzigtausendvierhundertvierundvierzig':'Es ist lang',
                'Arbeitsunf√§higkeitsbescheinigung':'Es ist lang',
                'Nahrungsmittelunvertr√§glichkeitstest':'Es ist lang',
                'Wiederbelebungsma√ünahmenleitfaden':'Es ist lang',
                'Selbstmitgef√ºhlskultivierungstechniken':'Es ist lang'
            },
            hint: 'Hinweis',
            brand: 'Vokabelwortfindungsherausforderung',
            flag: 'üá©üá™',
            strapline: 'Der Ultimate Deutsche Wortspiel!',

            keyboard: [
                ['Q', 'W', 'E', 'R', 'T', 'Z', 'U', 'I', 'O', 'P', '√ú', '√Ñ', '√ñ'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', '√ü', '‚å´', '‚èé'],
                ['Y', 'X', 'C', 'V', 'B', 'N', 'M', '', '', '', '', '', '']
            ]
        },

        dev: {
            options: {
                'boop':'it\'s boop',
            },
            hint: 'Hint',
            brand: 'Word Search - Debug Mode',
            flag: '[-]',
            strapline: 'Everybody\'s favourite debug mode!',

            keyboard: [
                ['Q', 'W', 'E', 'R', 'T', 'Z', 'U', 'I', 'O', 'P', '√ú', '√Ñ', '√ñ'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', '√ü', '‚å´', '‚èé'],
                ['Y', 'X', 'C', 'V', 'B', 'N', 'M', '-', '', '', '', '', '']
            ]
        },

        pl: {
            options: {
                'Dziewiƒôƒásetdziewiƒôƒádziesiƒôciodziewiƒôcionarodowo≈õciowego': 'To prawdopodobnie prawdziwe s≈Çowo',
                'KONSTANTYNOPOLITA≈ÉCZYKOWIANECZKA': 'To prawdopodobnie prawdziwe s≈Çowo',
                'Pierogi': 'To prawdopodobnie prawdziwe s≈Çowo',
            },
            hint: 'Wskaz√≥wka',
            brand: 'Polskie S≈Ç√≥wko',
            flag: 'üáµüá±',
            strapline: 'Najlepsza wyszukiwarka s≈Ç√≥w po polsku niezwiƒÖzana z Wordle',

            keyboard: [
                ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P', 'ƒÑ', 'ƒò'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', '≈Å', '‚å´'],
                ['Z', 'X', 'C', 'V', 'B', 'N', 'M', 'ƒÜ', '≈É', '√ì', '≈ö', '‚èé'],
                ['', '', '', '', '', '', '', '≈π', '≈ª', '', '', '']
            ]
        },


        za: {
            options: {
                'Elektrisiteitvoorsieningsonderbreking': 'Baie Suid-Afrikaners het hierdie probleem as gevolg van onderbefondsing van infrastruktuur.',
                'Tweedehandsemotorverkoopsmannevakbondstakingsvergaderingsameroeperstoespraakskrywerspersverklaringuitreikingsmediakonferensie-aankondiginkie': '141 letters en nie een van julle sal dit raai nie',
                'Waatlemoensaaiseisoen': 'Tyd om sappige vrugte te plant',
                'Vietsrykompetisiebeplanner': '!'
            },
            hint: 'Wenk',
            brand: 'Afrikaanse Woordspel',
            flag: 'üáøüá¶',
            strapline: 'Raai die Afrikaanse woord',

            keyboard: [
                ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P', '√ä'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', '‚å´'],
                ['Z', 'X', 'C', 'V', 'B', 'N', 'M', '√ã', '√é', '√î', '‚èé'],
                ['-', '', '', '', '', '', '', '√õ', '', '', '']
            ]
        },
    };

    const languageCode = new URLSearchParams(window.location.search).get('locale') || 'de';
    const board = localisations[languageCode];


    const entries = Object.entries(board.options);
    const randomEntry = entries[Math.floor(Math.random() * entries.length)];
    const TARGET_WORD = randomEntry[0].toUpperCase();
    const HINT = randomEntry[1];


    document.querySelector('.word-hint').innerHTML = `<strong>${board.hint}:</strong> ${HINT}`;
    document.querySelector('.subtitle').innerHTML = board.strapline;
    window.title = board.brand;
    document.title = board.brand;
    document.querySelector('h1').innerText = `${board.flag} ${window.title} ${board.flag}`;

    const MAX_ATTEMPTS = 6;
    const KEYBOARD_LAYOUT = board.keyboard;
    const WORD_LENGTH = TARGET_WORD.length;

    document.documentElement.style.setProperty('--keybwidth', KEYBOARD_LAYOUT[0].length);
    document.documentElement.style.setProperty('--wordlen', WORD_LENGTH);
    console.log(`Word Length: ${WORD_LENGTH}`);

    let currentRow = 0;
    let currentCol = 0;
    let gameOver = false;
    let gameMode = 'wordle'; // Default game mode
    let wrongGuesses = 0;
    let guessedLetters = [];


    function initializeGrid() {
        const grid = document.getElementById('grid');
        for (let i = 0; i < MAX_ATTEMPTS * WORD_LENGTH; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.id = `cell-${i}`;
            grid.appendChild(cell);
        }
    }

    function initializeKeyboard() {
        const keyboard = document.getElementById('keyboard');

        KEYBOARD_LAYOUT.forEach(row => {
            row.forEach(key => {
                if (key === '') return;

                const button = document.createElement('button');
                button.className = 'key';
                button.textContent = key;

                if (key === '‚å´' || key === '‚èé') {
                    button.className += ' wide';
                }

                button.addEventListener('click', () => handleKeyPress(key));
                keyboard.appendChild(button);
            });
        });
    }

    function handleKeyPress(key) {
        if (gameOver) return;

        if (gameMode === 'wordle') {
            // Wordle mode key handling
            if (key === '‚å´') {
                deleteLetter();
            } else if (key === '‚èé') {
                submitGuess();
            } else {
                addLetter(key);
            }
        } else {
            // Hangman mode key handling
            if (key === '‚å´' || key === '‚èé') {
                // These keys don't do anything in hangman mode
                return;
            } else {
                // Check if the letter has already been guessed
                if (guessedLetters.includes(key)) {
                    showMessage(`You already guessed ${key}!`);
                    return;
                }

                // Add to guessed letters
                guessedLetters.push(key);

                // Check the guess
                checkHangmanGuess(key);
            }
        }
    }

    function addLetter(letter) {
        if (currentCol < WORD_LENGTH) {
            const cellIndex = currentRow * WORD_LENGTH + currentCol;
            const cell = document.getElementById(`cell-${cellIndex}`);
            cell.textContent = letter;
            cell.classList.add('filled');
            currentCol++;
        }
    }

    function deleteLetter() {
        if (currentCol > 0) {
            currentCol--;
            const cellIndex = currentRow * WORD_LENGTH + currentCol;
            const cell = document.getElementById(`cell-${cellIndex}`);
            cell.textContent = '';
            cell.classList.remove('filled');
        }
    }

    function submitGuess() {
        if (currentCol !== WORD_LENGTH) {
            showMessage(`Please enter all ${WORD_LENGTH} letters!`);
            return;
        }

        const guess = getCurrentGuess();
        evaluateGuess(guess);

        if (guess === TARGET_WORD) {
            showMessage('Congratulations!', 'win');
            gameOver = true;
        } else if (currentRow === MAX_ATTEMPTS - 1) {
            showMessage(`Sorry! The word was: ${TARGET_WORD}`, 'lose');
            gameOver = true;
        } else {
            currentRow++;
            currentCol = 0;
            showMessage(`Versuch ${currentRow + 1} von ${MAX_ATTEMPTS}`);
        }
    }

    function getCurrentGuess() {
        let guess = '';
        for (let i = 0; i < WORD_LENGTH; i++) {
            const cellIndex = currentRow * WORD_LENGTH + i;
            const cell = document.getElementById(`cell-${cellIndex}`);
            guess += cell.textContent;
        }
        return guess;
    }

    function evaluateGuess(guess) {
        const targetArray = TARGET_WORD.split('');
        const guessArray = guess.split('');
        const letterCount = {};

        // Count letters in target word
        targetArray.forEach(letter => {
            letterCount[letter] = (letterCount[letter] || 0) + 1;
        });

        // First pass: mark correct letters
        for (let i = 0; i < WORD_LENGTH; i++) {
            const cellIndex = currentRow * WORD_LENGTH + i;
            const cell = document.getElementById(`cell-${cellIndex}`);

            if (guessArray[i] === targetArray[i]) {
                cell.classList.add('correct');
                updateKeyboard(guessArray[i], 'correct');
                letterCount[guessArray[i]]--;
            }
        }

        // Second pass: mark present letters
        for (let i = 0; i < WORD_LENGTH; i++) {
            const cellIndex = currentRow * WORD_LENGTH + i;
            const cell = document.getElementById(`cell-${cellIndex}`);

            if (guessArray[i] !== targetArray[i]) {
                if (letterCount[guessArray[i]] > 0) {
                    cell.classList.add('present');
                    updateKeyboard(guessArray[i], 'present');
                    letterCount[guessArray[i]]--;
                } else {
                    cell.classList.add('absent');
                    updateKeyboard(guessArray[i], 'absent');
                }
            }
        }
    }

    function updateKeyboard(letter, status) {
        const keys = document.querySelectorAll('.key');
        keys.forEach(key => {
            if (key.textContent === letter) {
                // Don't downgrade from correct to present/absent
                if (!key.classList.contains('correct')) {
                    key.classList.remove('present', 'absent', 'correct');
                    key.classList.add(status);
                }
            }
        });
    }

    function showMessage(text, className = '') {
        const messageEl = document.getElementById('message');
        messageEl.textContent = text;
        messageEl.className = `message ${className}`;
    }

    // Handle keyboard input
    document.addEventListener('keydown', (e) => {
        const key = e.key.toUpperCase();

        if (key === 'BACKSPACE') {
            handleKeyPress('‚å´');
        } else if (key === 'ENTER') {
            handleKeyPress('‚èé');
        }
        else if (/^\p{L}$/u.test(key) || key === '-') {
            handleKeyPress(key);
        }
    });

    // Mode switching functions
    function switchToWordleMode() {
        gameMode = 'wordle';
        document.getElementById('wordle-mode').classList.add('active');
        document.getElementById('hangman-mode').classList.remove('active');
        document.getElementById('wordle-container').style.display = 'block';
        document.getElementById('hangman-container').style.display = 'none';
        resetGame();
    }

    function switchToHangmanMode() {
        gameMode = 'hangman';
        document.getElementById('hangman-mode').classList.add('active');
        document.getElementById('wordle-mode').classList.remove('active');
        document.getElementById('wordle-container').style.display = 'none';
        document.getElementById('hangman-container').style.display = 'block';
        resetGame();
    }

    function resetGame() {
        // Reset game state
        currentRow = 0;
        currentCol = 0;
        gameOver = false;
        wrongGuesses = 0;
        guessedLetters = [];

        // Clear the grid
        const grid = document.getElementById('grid');
        grid.innerHTML = '';

        // Clear the keyboard
        const keyboard = document.getElementById('keyboard');
        keyboard.innerHTML = '';

        // Clear the hangman word display
        const hangmanWord = document.getElementById('hangman-word');
        hangmanWord.innerHTML = '';

        // Clear the hangman drawing
        const hangmanDrawing = document.getElementById('hangman-drawing');
        hangmanDrawing.innerHTML = '';

        // Initialize the game based on the current mode
        if (gameMode === 'wordle') {
            initializeGrid();
            initializeKeyboard();
            showMessage(`Guess the word! Attempt 1 of ${MAX_ATTEMPTS}`);
        } else {
            initializeHangman();
            initializeKeyboard(); // Reuse the keyboard for hangman
            showMessage(`Guess the word! You have 6 wrong guesses.`);
        }
    }

    function initializeHangman() {
        // Create the hangman drawing scaffold
        const hangmanDrawing = document.getElementById('hangman-drawing');
        hangmanDrawing.innerHTML = `
            <svg width="200" height="250" viewBox="0 0 200 250">
                <!-- Base -->
                <line x1="20" y1="230" x2="180" y2="230" stroke="#333" stroke-width="3"/>
                <!-- Vertical pole -->
                <line x1="40" y1="230" x2="40" y2="30" stroke="#333" stroke-width="3"/>
                <!-- Horizontal beam -->
                <line x1="40" y1="30" x2="120" y2="30" stroke="#333" stroke-width="3"/>
                <!-- Rope -->
                <line x1="120" y1="30" x2="120" y2="50" stroke="#333" stroke-width="3"/>

                <!-- These parts will be added as wrong guesses are made -->
                <circle id="head" cx="120" cy="70" r="20" stroke="#333" stroke-width="3" fill="transparent" style="display:none"/>
                <line id="body" x1="120" y1="90" x2="120" y2="150" stroke="#333" stroke-width="3" style="display:none"/>
                <line id="left-arm" x1="120" y1="110" x2="90" y2="100" stroke="#333" stroke-width="3" style="display:none"/>
                <line id="right-arm" x1="120" y1="110" x2="150" y2="100" stroke="#333" stroke-width="3" style="display:none"/>
                <line id="left-leg" x1="120" y1="150" x2="90" y2="180" stroke="#333" stroke-width="3" style="display:none"/>
                <line id="right-leg" x1="120" y1="150" x2="150" y2="180" stroke="#333" stroke-width="3" style="display:none"/>
            </svg>
        `;

        // Create the hangman word display
        const hangmanWord = document.getElementById('hangman-word');
        hangmanWord.innerHTML = '';

        for (let i = 0; i < TARGET_WORD.length; i++) {
            const letterBox = document.createElement('div');
            letterBox.className = 'hangman-letter';
            letterBox.id = `hangman-letter-${i}`;

            // Handle spaces and hyphens
            if (TARGET_WORD[i] === ' ' || TARGET_WORD[i] === '-') {
                letterBox.textContent = TARGET_WORD[i];
            }

            hangmanWord.appendChild(letterBox);
        }
    }

    function updateHangmanDrawing() {
        const parts = ['head', 'body', 'left-arm', 'right-arm', 'left-leg', 'right-leg'];
        if (wrongGuesses > 0 && wrongGuesses <= parts.length) {
            document.getElementById(parts[wrongGuesses - 1]).style.display = 'block';
        }
    }

    function checkHangmanGuess(letter) {
        let letterFound = false;

        // Check if the letter is in the target word
        for (let i = 0; i < TARGET_WORD.length; i++) {
            if (TARGET_WORD[i] === letter) {
                document.getElementById(`hangman-letter-${i}`).textContent = letter;
                letterFound = true;
            }
        }

        // Update game state based on the guess
        if (!letterFound) {
            wrongGuesses++;
            updateHangmanDrawing();
            updateKeyboard(letter, 'absent');

            if (wrongGuesses >= 6) {
                showMessage(`Sorry! The word was: ${TARGET_WORD}`, 'lose');
                gameOver = true;
            }
        } else {
            updateKeyboard(letter, 'correct');

            // Check if all letters have been guessed
            let allLettersGuessed = true;
            for (let i = 0; i < TARGET_WORD.length; i++) {
                const letterElement = document.getElementById(`hangman-letter-${i}`);
                if (TARGET_WORD[i] !== ' ' && TARGET_WORD[i] !== '-' && letterElement.textContent === '') {
                    allLettersGuessed = false;
                    break;
                }
            }

            if (allLettersGuessed) {
                showMessage('Congratulations!', 'win');
                gameOver = true;
            }
        }
    }

    // Add event listeners for mode buttons
    document.getElementById('wordle-mode').addEventListener('click', switchToWordleMode);
    document.getElementById('hangman-mode').addEventListener('click', switchToHangmanMode);

    // Initialize game
    initializeGrid();
    initializeKeyboard();
    initializeHangman(); // Initialize hangman mode as well

    // Set initial display states
    document.getElementById('wordle-container').style.display = 'block';
    document.getElementById('hangman-container').style.display = 'none';

    showMessage(`Guess the word! Attempt 1 of ${MAX_ATTEMPTS}`);
</script>
</body>
</html>
